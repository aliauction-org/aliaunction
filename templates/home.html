{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container" style="padding-top: 2rem;">
  <!-- Hero Section / Filter Bar -->
  <div style="margin-bottom: 3rem; text-align: center;">
    <h1 style="font-size: 2.5rem; color: var(--text-main); margin-bottom: 1rem;">Premium Auctions</h1>
    <p style="font-size: 1.1rem; color: var(--text-secondary); max-width: 600px; margin: 0 auto 2rem auto;">
      Discover unique items from verified sellers. Bid with confidence on our secure platform.
    </p>

    <!-- Search & Filter -->
    <form method="get" action=""
      style="display: flex; gap: 1rem; justify-content: center; max-width: 800px; margin: 0 auto; flex-wrap: wrap;">
      <input type="text" name="search" placeholder="Search for items..." value="{{ search_query|default:'' }}"
        style="flex: 1; min-width: 300px; padding: 0.8rem 1rem;">

      <select name="category" style="width: auto; min-width: 200px;">
        <option value="">All Categories</option>
        {% for category in categories %}
        <option value="{{ category.slug }}" {% if request.GET.category == category.slug %}selected{% endif %}>
          {{ category.name }}
        </option>
        {% endfor %}
      </select>

      <button type="submit" class="btn btn-primary">Search</button>
    </form>
  </div>

  <!-- Auction Grid -->
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 2rem;">
    {% for auction in auctions %}
    <div class="card">
      <a href="{% url 'auction_detail' auction.id %}" style="text-decoration: none; color: inherit; display: block;">
        <!-- Image Aspect Ratio Wrapper -->
        <div style="aspect-ratio: 4/3; overflow: hidden; background-color: #f1f5f9; position: relative;">
          {% if auction.image %}
          <img src="{{ auction.image.url }}" alt="{{ auction.title }}"
            style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
          {% else %}
          <div
            style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-muted);">
            No Image
          </div>
          {% endif %}

          {% if auction.is_featured %}
          <div
            style="position: absolute; top: 10px; right: 10px; background: var(--accent-color); color: white; padding: 4px 8px; font-size: 0.75rem; font-weight: 600; border-radius: 4px;">
            FEATURED
          </div>
          {% endif %}
        </div>

        <div class="card-body">
          <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; line-height: 1.4;">{{ auction.title|truncatechars:50 }}
          </h3>

          <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-top: 1rem;">
            <div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);">Current Bid</div>
              <div style="font-size: 1.25rem; font-weight: 700; color: var(--text-main);">â‚¹{{ auction.current_price }}
              </div>
            </div>

            <div style="text-align: right;">
              <div style="font-size: 0.85rem; color: var(--text-secondary);">Ends In</div>
              <div style="font-size: 0.95rem; font-weight: 500; font-variant-numeric: tabular-nums;">
                {% if auction.end_time|date:'U' < now|date:'U' %} <span style="color: var(--danger-color);">Ended</span>
                  {% else %}
                  {{ auction.end_time|timeuntil }}
                  {% endif %}
              </div>
            </div>
          </div>
        </div>
      </a>
    </div>
    {% empty %}
    <div style="grid-column: 1 / -1; text-align: center; padding: 4rem; color: var(--text-secondary);">
      <h3>No auctions found</h3>
      <p>Try adjusting your search criteria.</p>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}