{% extends "base.html" %}
{% load indian_format %}

{% block title %}My Watchlist{% endblock %}

{% block content %}
<div class="container" style="padding: 2rem 0;">

  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <div>
      <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;">‚≠ê My Watchlist</h1>
      <p style="color: var(--text-secondary);">Auctions you're keeping an eye on</p>
    </div>
    <a href="{% url 'auction_list' %}" class="btn btn-outline">Browse Auctions</a>
  </div>

  {% if items %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
    {% for item in items %}
    <div class="card" style="overflow: hidden;">
      <!-- Image -->
      <a href="{% url 'auction_detail' item.auction.id %}" style="display: block;">
        {% if item.auction.image %}
        <img src="{{ item.auction.image.url }}" alt="{{ item.auction.title }}"
          style="width: 100%; height: 180px; object-fit: cover;">
        {% else %}
        <div
          style="width: 100%; height: 180px; background: var(--bg-secondary); display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
          No Image
        </div>
        {% endif %}
      </a>

      <div class="card-body" style="padding: 1rem;">
        <h3 style="margin-bottom: 0.5rem; font-size: 1.1rem;">
          <a href="{% url 'auction_detail' item.auction.id %}" style="color: inherit; text-decoration: none;">
            {{ item.auction.title|truncatechars:40 }}
          </a>
        </h3>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
          <div>
            <div style="font-size: 0.85rem; color: var(--text-secondary);">Current Bid</div>
            <div style="font-size: 1.25rem; font-weight: 700; color: var(--text-main);">‚Çπ{{ item.auction.current_price|indian_format }}</div>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 0.85rem; color: var(--text-secondary);">Ends</div>
            <div style="font-size: 0.9rem; font-weight: 500;">{{ item.auction.end_time|date:"M d, h:i a" }}</div>
          </div>
        </div>

        <div style="display: flex; gap: 0.5rem;">
          <a href="{% url 'auction_detail' item.auction.id %}" class="btn btn-primary btn-sm"
            style="flex: 1; text-align: center;">
            View Auction
          </a>
          <a href="{% url 'toggle_watchlist' item.auction.id %}" class="btn btn-outline btn-sm" style="color: #ef4444;"
            title="Remove from Watchlist">
            ‚ùå
          </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div style="text-align: center; padding: 4rem 2rem; background: var(--bg-secondary); border-radius: 12px;">
    <div style="font-size: 3rem; margin-bottom: 1rem;">üîç</div>
    <h2 style="margin-bottom: 0.5rem;">Your watchlist is empty</h2>
    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Start watching auctions to keep track of items
      you're interested in.</p>
    <a href="{% url 'auction_list' %}" class="btn btn-primary">Browse Auctions</a>
  </div>
  {% endif %}

</div>
{% endblock %}